(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fbba6064"],{"8fa7":function(e,t,r){"use strict";r.r(t);r("b0c0");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"年级：",required:"",prop:"level"}},[t("el-select",{attrs:{placeholder:"年级"},on:{change:e.levelChange},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},e._l(e.levelEnum,(function(e){return t("el-option",{key:e.key,attrs:{value:e.key,label:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"学科：",prop:"subjectId"}},[t("el-select",{attrs:{placeholder:"学科"},model:{value:e.form.subjectId,callback:function(t){e.$set(e.form,"subjectId",t)},expression:"form.subjectId"}},e._l(e.subjectFilter,(function(e){return t("el-option",{key:e.id,attrs:{value:e.id,label:e.name+" ( "+e.levelName+" )"}})})),1)],1),t("el-form-item",{attrs:{label:"课程名称：",prop:"title"}},[t("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"封面：",required:"",prop:"picUrl"}},[t("el-upload",{attrs:{action:"https://jsonplaceholder.typicode.com/posts/","list-type":"picture-card",accept:".jpg, .jpeg, .png, .JPG, .JPEG",limit:1,"on-change":e.handleImgChange,"auto-upload":this.form.id,"with-credentials":!0,data:{id:this.form.id},"on-exceed":e.handleExceed}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"描述：",required:"",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),t("el-form-item",{attrs:{label:"课程视频：",required:"",prop:"videoUrl"}},[t("el-upload",{attrs:{action:"https://jsonplaceholder.typicode.com/posts/",accept:".mp4, .ogg, .flv, .avi, .wmv, .rmvb",limit:1,"on-change":e.handleVideoChange,"auto-upload":this.form.id,"with-credentials":!0,data:{id:this.form.id},"on-exceed":e.handleExceed}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")])],1)],1)],1)},l=[],a=r("5530"),o=(r("14d9"),r("4de4"),r("d3b7"),r("2f62")),n=r("cabd"),s={data:function(){return{form:{id:null,title:"",level:"",levelName:"",subjectId:"",remark:"",picUrl:null,videoUrl:null},formLoading:!1,subjectFilter:null,rules:{title:[{required:!0,message:"请输入名称",trigger:"blur"}],remark:[{required:!0,message:"请输入描述",trigger:"blur"}],subjectId:[{required:!0,message:"请选择学科",trigger:"blur"}],level:[{required:!0,message:"请选择年级",trigger:"blur"}],picUrl:[{required:!0,message:"选择图片",trigger:"blur"}],videoUrl:[{required:!0,message:"选择视频，最大512Mb",trigger:"blur"}]},picFile:null,videoFile:null}},created:function(){this.initSubject();var e=this.$route.query.id,t=this;e&&0!==parseInt(e)&&(t.formLoading=!0,n["a"].select(e).then((function(e){t.form=e.response,t.formLoading=!1})))},methods:Object(a["a"])(Object(a["a"])({submitForm:function(){var e=this,t=this;this.$refs["form"].validate((function(r){if(!r)return console.log("error submit!!"),!1;e.formLoading=!0,e.form.levelName=e.enumFormat(e.levelEnum,e.form.level);var i=new FormData;i.append("title",e.form.title),i.append("subjectId",e.form.subjectId),i.append("level",e.form.level),i.append("remark",e.form.remark),e.form.id||(i.append("file",e.picFile),i.append("file",e.videoFile)),n["a"].insert(i).then((function(e){1===e.code?(t.$message.success(e.message),t.delCurrentView(t).then((function(){t.$router.push("/course/list")}))):(t.$message.error(e.message),t.formLoading=!1)})).catch((function(e){t.formLoading=!1}))}))},resetForm:function(){var e=this.form.id;this.$refs["form"].resetFields(),this.form={id:null,title:"",level:"",levelName:"",videoUrl:"",picUrl:""},this.form.id=e},levelChange:function(){var e=this;this.form.subjectId=null,this.subjectFilter=this.subjects.filter((function(t){return t.level===e.form.level}))},handleImgChange:function(e,t){console.log("handleImgChange==",e),this.picFile=e.raw,this.form.picUrl=e.raw},handleVideoChange:function(e,t){var r=e.size/1024/1024<512;r?(this.form.videoUrl=e.raw,this.videoFile=e.raw):this.$message.error("上传视频大小不能超过 512MB!")},handleExceed:function(){this.$message.error("只能上传一个文件!")}},Object(o["b"])("tagsView",{delCurrentView:"delCurrentView"})),Object(o["b"])("exam",{initSubject:"initSubject"})),computed:Object(a["a"])(Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(o["c"])("enumItem",["enumFormat"])),Object(o["e"])("enumItem",{levelEnum:function(e){return e.user.levelEnum}})),Object(o["c"])("exam",["subjectEnumFormat"])),Object(o["e"])("exam",{subjects:function(e){return e.subjects}}))},c=s,u=(r("fe90"),r("2877")),m=Object(u["a"])(c,i,l,!1,null,"1a07026f",null);t["default"]=m.exports},cabd:function(e,t,r){"use strict";var i=r("b775");t["a"]={pageList:function(e){return Object(i["b"])("/api/admin/video/page/list",e)},insert:function(e){return Object(i["a"])("/api/admin/video/insert",e)},select:function(e){return Object(i["b"])("/api/admin/education/subject/select/"+e)},deleteCourse:function(e){return Object(i["b"])("/api/admin/video/delete/"+e)}}},fae4:function(e,t,r){},fe90:function(e,t,r){"use strict";r("fae4")}}]);